<html dir="rtl" lang="ar">
<head>
  <meta charset="utf-8" />
  <title>Ø§Ù„Ø­Ø±Ù…ÙŠÙ† - Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{font-family:'Segoe UI',Tahoma,sans-serif;background:#f8f9fa;margin:0;color:#1B5E20}
    .header{background:#1B5E20;color:#fff;padding:14px;text-align:center}
    .container{max-width:900px;margin:18px auto;padding:0 12px}
    .product{background:#fff;padding:12px;border-radius:8px;display:flex;gap:12px;align-items:center;margin:12px 0;box-shadow:0 2px 6px rgba(0,0,0,0.06)}
    .product img{width:140px;height:92px;object-fit:cover;border-radius:6px}
    .btn{background:#D4AF37;color:#1B5E20;border:none;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer}
    .cart-bar{position:fixed;left:18px;bottom:18px;background:#fff;padding:10px 12px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.12);display:flex;gap:10px;align-items:center}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);z-index:40}
    .modal .box{background:#fff;padding:18px;border-radius:10px;width:92%;max-width:520px;direction:rtl;color:#1B5E20}
    label{display:block;margin-top:8px;font-size:0.95rem}
    input,textarea,select{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid #ddd}
    .small{font-size:0.9rem;color:#666}
  </style>
</head>
<body>
  <div class="header">
    <h1>Ø§Ù„Ø­Ø±Ù…ÙŠÙ† Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</h1>
    <div class="small">ØªØ£Ø³Ø³Øª 1996 â€” ØªÙˆØµÙŠÙ„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</div>
  </div>
    <div class="container">
    <h2>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
    <div id="products"></div>
    <div style="margin-top:12px">
  <button id="openCheckout" class="btn">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</button>
</div>

<div style="margin-top:26px; text-align:center; color:#666">
  <div>ğŸ“ 0504392169 | 01009888281</div>
  <div>ğŸ“ Ø¨Ø±Ø¬ Ù†ÙˆØ± Ø§Ù„Ø­Ù…ØµØŒ Ù…Ø±ÙƒØ² Ø£Ø¬Ø§ØŒ Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</div>
</div>
  <div class="cart-bar" id="cartBar" style="display:none">
    <div>Ø§Ù„Ø³Ù„Ø©: <strong id="cartCount">0</strong></div>
    <div id="cartTotal">Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0 Ø¬.Ù…</div>
    <div><button id="viewCart" class="btn">Ø¹Ø±Ø¶</button></div>
  </div>
    <div class="modal" id="modal">
    <div class="box">
      <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3>
      <div id="cartItems" style="max-height:300px;overflow:auto"></div>
        <div style="margin-top:12px">
    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
    <input id="cName" placeholder="Ø§Ù„Ø§Ø³Ù…">
    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
    <input id="cPhone" placeholder="05xxxxxxxx">
    <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
    <textarea id="cAddress" rows="2" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"></textarea>
    <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
    <textarea id="cNotes" rows="2"></textarea>

    <label style="margin-top:10px">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>
    <select id="paymentMethod">
      <option value="cod">Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Ù†Ù‚Ø¯Ù‹Ø§)</option>
      <option value="paymob">Ø¯ÙØ¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ù…Ø­Ø§ÙƒØ§Ø©)</option>
    </select>
  </div>

  <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
    <button id="confirm" class="btn">ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
    <button id="close" class="btn" style="background:#eee;color:#1B5E20">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
</div>  <script>
    // Ù†Ø³Ø®Ø© Ø¹Ø±Ø¶ Ù…Ø­Ù„ÙŠØ© ÙÙ‚Ø· â€” Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Firebase. ØªØ­ÙØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙŠ localStorage.
    const PRODUCTS = [
      { id: '1', name: 'Ø¹Ø³Ù„ Ø·Ø¨ÙŠØ¹ÙŠ 100%', desc: 'Ø¹Ø³Ù„ Ø³Ø¯Ø± Ø®Ø§Ù„Øµ â€” 500 Ø¬Ù…', price: 85, img: 'https://via.placeholder.com/400x260?text=Ø¹Ø³Ù„' },
      { id: '2', name: 'Ø²ÙŠØª Ø²ÙŠØªÙˆÙ† Ø¨ÙƒØ± Ù…Ù…ØªØ§Ø²', desc: 'Ù…Ø¹ØµÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø§Ø±Ø¯ â€” 500 Ù…Ù„', price: 42, img: 'https://via.placeholder.com/400x260?text=Ø²ÙŠØª+Ø²ÙŠØªÙˆÙ†' }
    ];

    const cart = [];
    const deliveryFee = 15;

    function renderProducts(){
      const root = document.getElementById('products');
      root.innerHTML = '';
      PRODUCTS.forEach(p=>{
        const div = document.createElement('div');
        div.className = 'product';
        div.innerHTML = `
          <img src="${p.img}" alt="${p.name}">
          <div style="flex:1">
            <h3>${p.name}</h3>
            <div class="small">${p.desc}</div>
            <div style="margin-top:8px;font-weight:700">Ø§Ù„Ø³Ø¹Ø±: ${p.price} Ø¬.Ù…</div>
          </div>
          <div>
            <button class="btn add" data-id="${p.id}">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
          </div>
        `;
        root.appendChild(div);
      });
      document.querySelectorAll('.add').forEach(b=>{
        b.addEventListener('click', ()=> {
          const id = b.dataset.id;
          const p = PRODUCTS.find(x=>x.id===id);
          const it = cart.find(x=>x.id===id);
          if(it) it.qty++;
          else cart.push({ ...p, qty:1 });
          updateCartBar();
          alert('âœ“ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©');
        });
      });
    }

    function updateCartBar(){
      const count = cart.reduce((s,i)=>s+i.qty,0);
      const total = cart.reduce((s,i)=>s + i.qty * i.price,0) + (count>0 ? deliveryFee : 0);
      document.getElementById('cartCount').textContent = count;
      document.getElementById('cartTotal').textContent = 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ' + total + ' Ø¬.Ù…';
      document.getElementById('cartBar').style.display = count>0 ? 'flex' : 'none';
    }

    function openModal(){ renderCartItems(); document.getElementById('modal').style.display='flex'; }
    function closeModal(){ document.getElementById('modal').style.display='none'; }

    function renderCartItems(){
      const container = document.getElementById('cartItems');
      container.innerHTML = '';
      if(cart.length===0){ container.innerHTML = '<div>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©.</div>'; return; }
      cart.forEach(it=>{
        const el = document.createElement('div');
        el.style.display='flex'; el.style.justifyContent='space-between'; el.style.alignItems='center'; el.style.padding='8px 0';
        el.innerHTML = `<div><strong>${it.name}</strong><div class="small">${it.desc}</div></div>
                        <div style="text-align:left">
                          <div><button data-id="${it.id}" class="dec">-</button> <span>${it.qty}</span> <button data-id="${it.id}" class="inc">+</button></div>
                          <div style="font-weight:700;margin-top:6px">${it.price * it.qty} Ø¬.Ù…</div>
                        </div>`;
        container.appendChild(el);
      });
      container.querySelectorAll('.inc').forEach(b=>b.addEventListener('click', ()=>{ const id=b.dataset.id; cart.find(x=>x.id===id).qty++; renderCartItems(); updateCartBar(); }));
      container.querySelectorAll('.dec').forEach(b=>b.addEventListener('click', ()=>{ const id=b.dataset.id; const it=cart.find(x=>x.id===id); it.qty--; if(it.qty<=0) cart.splice(cart.indexOf(it),1); renderCartItems(); updateCartBar(); }));
    }

    document.getElementById('viewCart').addEventListener('click', openModal);
    document.getElementById('openCheckout').addEventListener('click', openModal);
    document.getElementById('close').addEventListener('click', closeModal);

    document.getElementById('confirm').addEventListener('click', ()=> {
      if(cart.length===0){ alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©'); return; }
      const name = document.getElementById('cName').value.trim();
      const phone = document.getElementById('cPhone').value.trim();
      const address = document.getElementById('cAddress').value.trim();
      const notes = document.getElementById('cNotes').value.trim();
      const paymentMethod = document.getElementById('paymentMethod').value;
      if(!name || !phone || !address){ alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ù…Ù„Ø£ Ø§Ù„Ø§Ø³Ù…ØŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù†'); return; }

      const items = cart.map(i=>({ id:i.id, name:i.name, qty:i.qty, price:i.price }));
      const subtotal = cart.reduce((s,i)=>s + i.qty * i.price,0);
      const total = subtotal + deliveryFee;
      const order = {
        id: 'local-' + Date.now(),
        customer: { name, phone, address, notes },
        items, subtotal, delivery: deliveryFee, total,
        status: paymentMethod === 'cod' ? 'pending' : 'payment_pending',
        paymentMethod,
        createdAt: new Date().toISOString()
      };

      // Ø­ÙØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙŠ localStorage (Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙ‚Ø·)
      const stored = JSON.parse(localStorage.getItem('haramain_orders') || '[]');
      stored.unshift(order);
      localStorage.setItem('haramain_orders', JSON.stringify(stored));

      if(paymentMethod === 'paymob'){
        window.open('https://example.com/checkout?order=' + encodeURIComponent(order.id), '_blank');
        alert('Ø³ÙŠØªÙ… ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ (Ù…Ø­Ø§ÙƒØ§Ø©). Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹ ÙŠØªØºÙŠØ± ÙˆØ¶Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ \"Ù…Ø¯ÙÙˆØ¹\". Ù‡Ø°Ù‡ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø­Ù„ÙŠØ©.');
      } else {
        alert('âœ“ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø­Ù„ÙŠØ§Ù‹. Ø³Ù†ØªØµÙ„ Ø¨Ùƒ Ù„ØªØ£ÙƒÙŠØ¯Ù‡.');
      }

      cart.length = 0;
      updateCartBar();
      closeModal();
    });

    function openAdminPreview(){
      const adminHtml = generateAdminHtml();
      const w = window.open();
      w.document.open();
      w.document.write(adminHtml);
      w.document.close();
    }

    function generateAdminHtml(){
      const orders = JSON.parse(localStorage.getItem('haramain_orders') || '[]');
      let list = '';
      if(orders.length === 0) list = '<div class="small">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø­Ù„ÙŠØ©.</div>';
      else orders.forEach(o=>{
        list += `<div style="background:#fff;padding:12px;border-radius:8px;margin-bottom:8px">
          <div><strong>${o.id}</strong> â€” ${o.customer.name} â€” ${o.customer.phone}</div>
          <div class="small">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${o.customer.address}</div>
          <div class="small">Ø§Ù„ÙˆÙ‚Øª: ${o.createdAt}</div>
          <div style="margin-top:6px">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${o.total} Ø¬.Ù… â€” Ø§Ù„Ø­Ø§Ù„Ø©: <strong>${o.status}</strong></div>
          <div style="margin-top:6px"><button onclick="(function(){ const arr=JSON.parse(localStorage.getItem('haramain_orders')||'[]'); arr[0].status='confirmed'; localStorage.setItem('haramain_orders', JSON.stringify(arr)); alert('ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø£ÙˆÙ„ Ø·Ù„Ø¨ (Ù…Ø­Ù„ÙŠ)'); })()" class="btn">ØªØ£ÙƒÙŠØ¯ Ø£ÙˆÙ„ Ø·Ù„Ø¨ (Ù…Ø­Ù„ÙŠ)</button></div>
        </div>`;
      });
      return `<!doctype html><html dir="rtl"><head><meta charset="utf-8"><title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© - Ù…Ø¹Ø§ÙŠÙ†Ø©</title><meta name="viewport" content="width=device-width,initial-scale=1"><style>body{font-family:Arial,sans-serif;background:#f2f4f3;color:#1B5E20;padding:18px} .btn{background:#D4AF37;color:#1B5E20;border:none;padding:8px;border-radius:6px;cursor:pointer}</style></head><body><h2>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© - Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø­Ù„ÙŠØ©</h2>${list}<p>Ù‡Ø°Ù‡ Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ù…Ø­Ù„ÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙ‚Ø·.</p></body></html>`;
